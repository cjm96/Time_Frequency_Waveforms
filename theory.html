

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mathematical Background &mdash; TimeFrequencyWaveforms 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=aca8e19c" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=d45e8c67"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="TimeFrequencyWaveforms.code.utils module" href="api/TimeFrequencyWaveforms.code.utils.html" />
    <link rel="prev" title="TimeFrequencyWaveforms Documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            TimeFrequencyWaveforms
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Mathematical Background:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Mathematical Background</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wdm-wavelets">WDM Wavelets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fast-wavelet-transform-td-rightarrow-tfd">Fast Wavelet Transform (TD <span class="math notranslate nohighlight">\(\rightarrow\)</span> TFD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fast-wavelet-transform-fd-rightarrow-tfd">Fast Wavelet Transform (FD <span class="math notranslate nohighlight">\(\rightarrow\)</span> TFD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="#appendices">Appendices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#appendix-a-derivation-of-time-shift-properties">Appendix A: Derivation of Time-Shift Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#appendix-b-derivation-of-freq-shift-properties">Appendix B: Derivation of Freq-Shift Properties</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/TimeFrequencyWaveforms.code.utils.html">TimeFrequencyWaveforms.code.utils module</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/TimeFrequencyWaveforms.code.TD_to_TFD_transform.html">TimeFrequencyWaveforms.code.TD_to_TFD_transform module</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">TimeFrequencyWaveforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Example Notebooks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code Repository:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="GitHub.html">GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TimeFrequencyWaveforms</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Mathematical Background</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/theory.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mathematical-background">
<h1>Mathematical Background<a class="headerlink" href="#mathematical-background" title="Link to this heading"></a></h1>
<p>This section describes the mathematical background to the fast wavelet transform of
harmonic-based GW waveform models.</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id15">Introduction</a></p></li>
<li><p><a class="reference internal" href="#wdm-wavelets" id="id16">WDM Wavelets</a></p></li>
<li><p><a class="reference internal" href="#fast-wavelet-transform-td-rightarrow-tfd" id="id17">Fast Wavelet Transform (TD <span class="math notranslate nohighlight">\(\rightarrow\)</span> TFD)</a></p></li>
<li><p><a class="reference internal" href="#fast-wavelet-transform-fd-rightarrow-tfd" id="id18">Fast Wavelet Transform (FD <span class="math notranslate nohighlight">\(\rightarrow\)</span> TFD)</a></p></li>
<li><p><a class="reference internal" href="#references" id="id19">References</a></p></li>
<li><p><a class="reference internal" href="#appendices" id="id20">Appendices</a></p></li>
<li><p><a class="reference internal" href="#appendix-a-derivation-of-time-shift-properties" id="id21">Appendix A: Derivation of Time-Shift Properties</a></p></li>
<li><p><a class="reference internal" href="#appendix-b-derivation-of-freq-shift-properties" id="id22">Appendix B: Derivation of Freq-Shift Properties</a></p></li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>Gravitational waveform models are usually constructed in either the time domain
(TD; <span class="math notranslate nohighlight">\(h_+(t)\)</span>, <span class="math notranslate nohighlight">\(h_\times(t)\)</span>) or the frequency domain (FD;
<span class="math notranslate nohighlight">\(\tilde{h}_+(f)\)</span>, <span class="math notranslate nohighlight">\(\tilde{h}_\times(f)\)</span>).
If gravitational wave data analysis is to be performed in the time-frequency domain
(TFD) then it is also necessary to transform our models into this TFD.</p>
<p>This document describes a fast method for transforming harmonic-based waveforms from either the
time to the time-frequency domain (TD <span class="math notranslate nohighlight">\(\rightarrow\)</span> TFD) of from the
frequency to the time-frequency domain (FD  <span class="math notranslate nohighlight">\(\rightarrow\)</span> TFD).
These fast transforms rely on expanding the waveform phase (e.g.as a function of time) in each harmonic.
This requires that the frequency is slowly varying over the scale of the wavelets.
These fast transforms have some similarities with the stationary phase approximation which is used
to compute the Fourier transform between the time and frequency domains.</p>
<p>The next section starts by reviewing the Wilson-Daubechies-Meyer (WDM) wavelets which are used
throughout as a basis for the TFD.
The fast TD <span class="math notranslate nohighlight">\(\rightarrow\)</span> TFD and FD <span class="math notranslate nohighlight">\(\rightarrow\)</span> TFD transforms are described in
subsequent two sections respectively.</p>
</section>
<section id="wdm-wavelets">
<h2><a class="toc-backref" href="#id16" role="doc-backlink">WDM Wavelets</a><a class="headerlink" href="#wdm-wavelets" title="Link to this heading"></a></h2>
<p>The WDM family of wavelets are implemented in the <cite>WDM_GW_wavelets</cite> package
<a class="reference external" href="https://cjm96.github.io/WDM_GW_wavelets/index.html">(WDM docs)</a>; see also Ref. <a class="footnote-reference brackets" href="#id5" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> and Ref. <a class="footnote-reference brackets" href="#id6" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.
The basis wavelets can be written as</p>
<div class="math notranslate nohighlight" id="equation-theory-0">
<span class="eqno">(1)<a class="headerlink" href="#equation-theory-0" title="Link to this equation"></a></span>\[\begin{split}g_{nm}(t) =
    \begin{cases}
    \sqrt{2} \cos\left(2\pi m [t-n\Delta T] \Delta F\right) \phi(t-n\Delta T) &amp; \mathrm{if}\;n+m\;\mathrm{even} \\
    \sqrt{2} (-1)^{nm} \sin\left(2\pi m [t-n\Delta T] \Delta F\right) \phi(t-n\Delta T) &amp; \mathrm{if}\;n+m\;\mathrm{odd}
\end{cases} ,\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi(t)\)</span> is a universal window function.
The <span class="math notranslate nohighlight">\(n\)</span> index shifts the central time <span class="math notranslate nohighlight">\(n\Delta T\)</span> of the wavelet while the
<span class="math notranslate nohighlight">\(m\)</span> index shifts the central frequency <span class="math notranslate nohighlight">\(m\Delta F\)</span>.
The wavelet time and frequency resolutions satisfy <span class="math notranslate nohighlight">\(\Delta F \Delta T=1/2\)</span>.
These expressions hold for all values of <span class="math notranslate nohighlight">\(n=0,1,\ldots, N_{t}-1\)</span> but only for non-zero values of
<span class="math notranslate nohighlight">\(m=1,2,\ldots, N_{f}-1\)</span>; the <span class="math notranslate nohighlight">\(m=0\)</span> wavelets store the zero and Nyquist frequency components of the signal
and have to be handled separately.
It will also be necessary to use the dual WDM wavelet basis;</p>
<div class="math notranslate nohighlight" id="equation-theory-1">
<span class="eqno">(2)<a class="headerlink" href="#equation-theory-1" title="Link to this equation"></a></span>\[\begin{split}\hat{g}_{nm}(t) =
    \begin{cases}
    \sqrt{2} \sin\left(2\pi m [t-n\Delta T] \Delta F\right) \phi(t-n\Delta T) &amp; \mathrm{if}\;n+m\;\mathrm{even} \\
    \sqrt{2} (-1)^{nm} \cos\left(2\pi m [t-n\Delta T] \Delta F\right) \phi(t-n\Delta T) &amp; \mathrm{if}\;n+m\;\mathrm{odd} \\
\end{cases}.\end{split}\]</div>
<p>The two bases are related by a time shift <span class="math notranslate nohighlight">\(\Delta T/2\)</span> and span exactly the same space; see the
discussion in Ref. <a class="footnote-reference brackets" href="#id5" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
</section>
<section id="fast-wavelet-transform-td-rightarrow-tfd">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">Fast Wavelet Transform (TD <span class="math notranslate nohighlight">\(\rightarrow\)</span> TFD)</a><a class="headerlink" href="#fast-wavelet-transform-td-rightarrow-tfd" title="Link to this heading"></a></h2>
<p>Suppose we are given a waveform in the TD defined in terms of its amplitude <span class="math notranslate nohighlight">\(A(t)\)</span> and phase <span class="math notranslate nohighlight">\(\Phi(t)\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-theory-2">
<span class="eqno">(3)<a class="headerlink" href="#equation-theory-2" title="Link to this equation"></a></span>\[h(t) \equiv h^+(t)-ih^\times(t) = A(t) \exp\big(i \Phi(t)\big) .\]</div>
<p>Suppose the amplitude and frequency (<span class="math notranslate nohighlight">\(2\pi f(t) = \mathrm{d}\Phi/\mathrm{d}t\)</span>) change slowly with time;
i.e.they change by a small amount over the wavelet timescale <span class="math notranslate nohighlight">\(\Delta T\)</span>.
This is a signal harmonic and a waveform may contain a sum of such harmonics.
This is what is meant above by “harmonic-based waveform”.</p>
<p>The wavelet coefficients are defined as</p>
<div class="math notranslate nohighlight" id="equation-theory-3">
<span class="eqno">(4)<a class="headerlink" href="#equation-theory-3" title="Link to this equation"></a></span>\[w_{nm} \equiv w^+_{nm} -i w^\times_{nm} = \int_{-\infty}^\infty\mathrm{d}t\;h(t)g_{nm}(t).\]</div>
<p>Strictly speaking the wavelet coefficients for the discrete wavelet transform involve a sum (not an integral) over
the time series <span class="math notranslate nohighlight">\(t_i=i\delta t\)</span> for <span class="math notranslate nohighlight">\(i=0,1,\ldots, N-1\)</span>, where <span class="math notranslate nohighlight">\(N=N_t N_f\)</span>.
However, most of our expressions will be unaffected by changing from a sum to an integral so we continue to use
this nicer notation.</p>
<p>The basis wavelet <span class="math notranslate nohighlight">\(g_{nm}(t)\)</span> is well localised around the time <span class="math notranslate nohighlight">\(t\sim t_n\pm\Delta T\)</span>.
Motivated by the fact that the amplitude and frequency are slowly varying, we Taylor expand these quantities about
<span class="math notranslate nohighlight">\(t_n\)</span>;</p>
<div class="math notranslate nohighlight" id="equation-theory-4">
<span class="eqno">(5)<a class="headerlink" href="#equation-theory-4" title="Link to this equation"></a></span>\[A(t) = A(t_n) + \mathcal{O}(t-t_n)\]</div>
<div class="math notranslate nohighlight" id="equation-theory-5">
<span class="eqno">(6)<a class="headerlink" href="#equation-theory-5" title="Link to this equation"></a></span>\[\Phi(t) = \Phi(t_n) + 2\pi f(t_n) (t-t_n) + \pi \dot{f}(t_n) (t-t_n)^2 + \mathcal{O}\big((t-t_n)^3\big)\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-theory-6">
<span class="eqno">(7)<a class="headerlink" href="#equation-theory-6" title="Link to this equation"></a></span>\[f(t) = \frac{1}{2\pi}\frac{\mathrm{d}}{\mathrm{d}t}\Phi(t)\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-theory-7">
<span class="eqno">(8)<a class="headerlink" href="#equation-theory-7" title="Link to this equation"></a></span>\[\dot{f}(t) = \frac{1}{2\pi}\frac{\mathrm{d}^2}{\mathrm{d}t^2}\Phi(t)\]</div>
<p>and so on for higher derivatives.</p>
<p>It is important that the amplitude is expanded only to zeroth order (as shown above) but the phase can be expanded to
any order depending on the accuracy needed.
Substituting these expansions into the definition of the wavelet coefficients gives</p>
<div class="math notranslate nohighlight" id="equation-theory-8">
<span class="eqno">(9)<a class="headerlink" href="#equation-theory-8" title="Link to this equation"></a></span>\[w_{nm} = A(t_n)\exp\big(i\Phi(t_n)\big)\left(c_{nm}\big(f(t_n),\dot{f}(t_n), \ldots\big) + i s_{nm}\big(f(t_n),\dot{f}(t_n), \ldots\big) \right),\]</div>
<p>where we have defined</p>
<div class="math notranslate nohighlight" id="equation-theory-9">
<span class="eqno">(10)<a class="headerlink" href="#equation-theory-9" title="Link to this equation"></a></span>\[c_{nm}(f, \dot{f}, \ldots) = \int\mathrm{d}t\;\cos X_n(f, \dot{f}, \ldots) g_{nm}(t) ,\]</div>
<div class="math notranslate nohighlight" id="equation-theory-10">
<span class="eqno">(11)<a class="headerlink" href="#equation-theory-10" title="Link to this equation"></a></span>\[s_{nm}(f, \dot{f}, \ldots) = \int\mathrm{d}t\;\sin X_n(f, \dot{f}, \ldots) g_{nm}(t) ,\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-theory-11">
<span class="eqno">(12)<a class="headerlink" href="#equation-theory-11" title="Link to this equation"></a></span>\[X_n(f,\dot{f},\ldots) = 2\pi(t-n\Delta T)f+\pi(t-n\Delta T)^2\dot{f} + \ldots \quad .\]</div>
<p>It will also be necessary to use the dual coefficients <span class="math notranslate nohighlight">\(\hat{c}_{nm}\)</span> and <span class="math notranslate nohighlight">\(\hat{s}_{nm}\)</span> defined similarly using
<span class="math notranslate nohighlight">\(\hat{g}_{nm}\)</span>.</p>
<p>Our approach will be to evaluate the waveform amplitude (<span class="math notranslate nohighlight">\(A(t_n)\)</span>), phase (<span class="math notranslate nohighlight">\(\Phi(t_n)\)</span>), and as many phase derivatives (<span class="math notranslate nohighlight">\(f(t_n)\)</span>, <span class="math notranslate nohighlight">\(\dot{f}(t_n)\)</span>, …) as required at the wavelet times <span class="math notranslate nohighlight">\(t_n\)</span>;
note, that this is much sparser grid of times than that of the original time series.
We will then evaluate the quantities <span class="math notranslate nohighlight">\(c_{nm}\)</span> and <span class="math notranslate nohighlight">\(s_{nm}\)</span> by interpolating these as functions of
<span class="math notranslate nohighlight">\(f\)</span>, <span class="math notranslate nohighlight">\(\dot{f}\)</span>, … over a precomputed grid of points.
Finally, the wavelet coefficients will be obtained using the above expression for <span class="math notranslate nohighlight">\(w_{nm}\)</span>.
By pre-computing and interpolating <span class="math notranslate nohighlight">\(c_{nm}\)</span> and <span class="math notranslate nohighlight">\(s_{nm}\)</span> this approach amortizes the cost of evaluating the oscillatory integrals
over time involved in transforming to the TFD.</p>
<p>The interpolation of the <span class="math notranslate nohighlight">\(c_{nm}\)</span> and <span class="math notranslate nohighlight">\(s_{nm}\)</span> coefficients is greatly aided by the following observations:
first, to a good approximation the coefficients only depend on the parity of the index <span class="math notranslate nohighlight">\(n\)</span>;
and second, these quantities have a shift symmetry in frequency which relates the coefficients at a frequency
<span class="math notranslate nohighlight">\(f\)</span> to the coefficients at <span class="math notranslate nohighlight">\(f+2\Delta F\)</span>.
The importance of the first observation is that it means it only necessary to interpolate one row of the coefficient matrices.
The importance of the second observation is that it is only necessary to interpolate over a narrow range of frequencies and the
coefficients at any frequency can then be obtained by shifting by even multiples of <span class="math notranslate nohighlight">\(\Delta F\)</span>.
We now describe these two observations in turn.</p>
<p>OBSERVATION 1:</p>
<p>This observation means the coefficients only depend on the parity of the index <span class="math notranslate nohighlight">\(n\)</span>.
This can be made precise using the following results derived in appendix A that relate the coefficients at a general
<span class="math notranslate nohighlight">\(n\)</span> to the coefficients at a fixed even index <span class="math notranslate nohighlight">\(\mathcal{N}\)</span>;</p>
<div class="math notranslate nohighlight" id="equation-theory-12">
<span class="eqno">(13)<a class="headerlink" href="#equation-theory-12" title="Link to this equation"></a></span>\[\begin{split}c_{nm}(f, \dot{f},\ldots) = \begin{cases}
    c_{\mathcal{N}m}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{even} \\
    \hat{c}_{\mathcal{N}m}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{odd}
\end{cases} ,\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-theory-13">
<span class="eqno">(14)<a class="headerlink" href="#equation-theory-13" title="Link to this equation"></a></span>\[\begin{split}s_{nm}(f, \dot{f},\ldots) = \begin{cases}
    s_{\mathcal{N}m}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{even} \\
    \hat{s}_{\mathcal{N}m}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{odd}
\end{cases} .\end{split}\]</div>
<p>If we use these results, then we see that it is only necessary to compute the coefficients <span class="math notranslate nohighlight">\(c_{nm}\)</span> and <span class="math notranslate nohighlight">\(s_{nm}\)</span>
for a single value of the index <span class="math notranslate nohighlight">\(n=\mathcal{N}\)</span> (provided we also compute <span class="math notranslate nohighlight">\(\hat{c}_{\mathcal{N}m}\)</span>
and <span class="math notranslate nohighlight">\(\hat{s}_{\mathcal{N}m}\)</span>) and all other coefficients with general <span class="math notranslate nohighlight">\(n\)</span> can be obtained from just these.</p>
<p>Unfortunately, these time-shift equations do not hold exactly for the discrete wavelet transform.
These expressions were derived in Appendix A using the integral expressions (over <span class="math notranslate nohighlight">\(t\in(-\infty,\infty)\)</span>) for the
wavelet coefficients.
When using finite sums, the periodic boundary conditions spoil the time-translation properties of the wavelets used in the
derivation.
The result is that these expressions are only valid for wavelets localised away from the beginning or end of the time range.
This is illustrated in <a class="reference internal" href="#fig-cnm-nshift"><span class="std std-numref">Figure 1</span></a>.
For this reason, we choose <span class="math notranslate nohighlight">\(\mathcal{N}\)</span> to be somewhere nicely in the middle of the time series.</p>
<p>All numerical results shown here were obtained with a time series duration <span class="math notranslate nohighlight">\(T=2^{16}\,\mathrm{s}\)</span> and sampling frequency
of <span class="math notranslate nohighlight">\(1/\delta t = 1\,\mathrm{Hz}\)</span>.
The basis wavelets have <span class="math notranslate nohighlight">\(N_t=512\)</span>, <span class="math notranslate nohighlight">\(q=16\)</span>, <span class="math notranslate nohighlight">\(d=4\)</span> and <span class="math notranslate nohighlight">\(A=\pi /512\,\mathrm{rad}\,\mathrm{s}^{-1}\)</span>;
these choices lead to <span class="math notranslate nohighlight">\(N_f=128\)</span> and time-frequency resolutions <span class="math notranslate nohighlight">\(\Delta T=128\,\mathrm{s}\)</span> and
<span class="math notranslate nohighlight">\(\Delta F=256^{-1}\,\mathrm{Hz}\)</span>.
It will be convenient to fix a reference frequency, this is taken to be half the Nyquist frequency, or
<span class="math notranslate nohighlight">\(f_{\rm ref}=N_f\Delta F/2\)</span>.</p>
<figure class="align-center" id="id7">
<span id="fig-cnm-nshift"></span><a class="reference internal image-reference" href="_images/cnm_n.png"><img alt="cnm_n" src="_images/cnm_n.png" style="width: 70%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 1 </span><span class="caption-text">This plot shows the coefficient <span class="math notranslate nohighlight">\(c_{nm}(f)\)</span> for several value of <span class="math notranslate nohighlight">\(f\)</span> (<span class="math notranslate nohighlight">\(\dot{f}\)</span> and all higher
derivatives are set to zero) for a fixed value of <span class="math notranslate nohighlight">\(m=N_f/2\)</span> plotted as a function of the index <span class="math notranslate nohighlight">\(n\)</span> for
even values (i.e.<span class="math notranslate nohighlight">\(n=0,2,4,\ldots, N_t-2\)</span>).
To an good approximation the <span class="math notranslate nohighlight">\(c_{nm}\)</span> coefficients do not depend on the index <span class="math notranslate nohighlight">\(n\)</span>;
this approximation breaks down near the ends of the time series where the periodic boundaries are significant.</span><a class="headerlink" href="#id7" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>OBSERVATION 2:</p>
<p>This observation allows the coefficients at a frequency shifted by an even multiple of the wavelet resolution
<span class="math notranslate nohighlight">\(\Delta F\)</span> to be written in terms of the coefficients evaluated at the reference frequency.
This can be made precise using the following results derived in appendix B that relate the coefficients at frequency
<span class="math notranslate nohighlight">\(f+2z\Delta F\)</span> to the coefficients at frequency <span class="math notranslate nohighlight">\(f\)</span> for any integer <span class="math notranslate nohighlight">\(z\)</span>;</p>
<div class="math notranslate nohighlight" id="equation-theory-14">
<span class="eqno">(15)<a class="headerlink" href="#equation-theory-14" title="Link to this equation"></a></span>\[c_{nm}(f+2z\Delta F) \!=\! \frac{1}{2} \left( c_{n(m-2z)}(f) + c_{n(m+2z)}(f) + (-1)^{n+m} \hat{s}_{n(m-2z)}(f) - (-1)^{n+m} \hat{s}_{n(m+2z)}(f) \right) ,\]</div>
<div class="math notranslate nohighlight" id="equation-theory-15">
<span class="eqno">(16)<a class="headerlink" href="#equation-theory-15" title="Link to this equation"></a></span>\[s_{nm}(f+2z\Delta F) \!=\! \frac{1}{2} \left( s_{n(m-2z)}(f) + s_{n(m+2z)}(f) - (-1)^{n+m} \hat{c}_{n(m-2z)}(f) + (-1)^{n+m} \hat{c}_{n(m+2z)}(f) \right) .\]</div>
<p>Using these results, we see that it is only necessary to interpolate the coefficients over a narrow range
<span class="math notranslate nohighlight">\(f_{\rm ref}\leq f&lt;f_{\rm ref}+2\Delta F\)</span> in frequency.
We choose the fixed reference frequency <span class="math notranslate nohighlight">\(f_{\rm ref}\)</span> to be somewhere nicely in the middle of the bandwidth of interest.
A general frequency <span class="math notranslate nohighlight">\(f\)</span> can be written as the sum of a piece in this ranges <span class="math notranslate nohighlight">\(F(f)\)</span> and a shift by an even multiple
<span class="math notranslate nohighlight">\(2z(f)\)</span> of <span class="math notranslate nohighlight">\(\Delta F\)</span>;</p>
<div class="math notranslate nohighlight" id="equation-theory-16">
<span class="eqno">(17)<a class="headerlink" href="#equation-theory-16" title="Link to this equation"></a></span>\[f = F(f) + 2z(f) \Delta F ,\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-theory-17">
<span class="eqno">(18)<a class="headerlink" href="#equation-theory-17" title="Link to this equation"></a></span>\[F(f) = \big(f-f_{\rm ref}\big)\,\mathrm{mod}\,(2\Delta F) + f_{\rm ref}\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-theory-18">
<span class="eqno">(19)<a class="headerlink" href="#equation-theory-18" title="Link to this equation"></a></span>\[z(f) = \left\lfloor \frac{f-f_{\rm ref}}{2\Delta F}\right\rfloor .\]</div>
<p>An example of the data to be interpolated is shown in <a class="reference internal" href="#fig-interp-data"><span class="std std-numref">Figure 2</span></a>.</p>
<figure class="align-center" id="id8">
<span id="fig-interp-data"></span><a class="reference internal image-reference" href="_images/cnm_f.png"><img alt="interp_data" src="_images/cnm_f.png" style="width: 70%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 2 </span><span class="caption-text">An example of the coefficient data to be interpolated. Here the coefficients
<span class="math notranslate nohighlight">\(c_{nm}(f,\dot{f})\)</span> are plotted as a function of frequency in the range <span class="math notranslate nohighlight">\(f_{\rm ref}&lt;f&lt;f_{\rm ref}+2\Delta F\)</span>.
The time index is fixed to <span class="math notranslate nohighlight">\(n=N_t/2\)</span> and results are shown for several values of <span class="math notranslate nohighlight">\(m\)</span> close to the reference
frequency. The frequency derivative is fixed to <span class="math notranslate nohighlight">\(\dot{f}=10^{-5}\,\mathrm{Hz}\,\mathrm{s}^{-1}\)</span>.</span><a class="headerlink" href="#id8" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>We are now in a position to describe the fast wavelet transform (TD <span class="math notranslate nohighlight">\(\rightarrow\)</span> TFD).
The following steps must be performed once to set up the transformer:</p>
<ul class="simple">
<li><p>Fix the properties of the times series. This involves choosing the time series parameters: e.g.duration <span class="math notranslate nohighlight">\(T\)</span>, sampling frequency <span class="math notranslate nohighlight">\(1/\delta t\)</span>, number of samples <span class="math notranslate nohighlight">\(N\)</span>, etc.</p></li>
<li><p>Fix the wavelet basis. This involves choosing the wavelet parameters: e.g. the time-frequency resolution <span class="math notranslate nohighlight">\(\Delta T\)</span> and <span class="math notranslate nohighlight">\(\Delta F\)</span> and the shape parameters of the mother wavelet <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(q\)</span> and <span class="math notranslate nohighlight">\(d\)</span>.</p></li>
<li><p>Choose how many terms to include in the phase expansion, i.e. how many frequency derivatives to interpolate over. This choice is related to the wavelet resolution <span class="math notranslate nohighlight">\(\Delta T\)</span> and maximum expected chirp rate of the waveform with faster chirps and finer resolutions generally requiring more derivatives. By default we will include only the <span class="math notranslate nohighlight">\(f\)</span> term.</p></li>
<li><p>Fix values the reference values for <span class="math notranslate nohighlight">\(\mathcal{N}\)</span> and <span class="math notranslate nohighlight">\(f_{\rm ref}=\mathcal{M}\Delta F\)</span>. By default we use the following integers near the middle of the allowed time and frequency ranges; <span class="math notranslate nohighlight">\(\mathcal{N} = 2\lfloor N_t/4 \rfloor\)</span> and <span class="math notranslate nohighlight">\(\mathcal{M} = \lfloor N_f/2 \rfloor\)</span>.</p></li>
<li><p>Set up regular grids for the interpolation of the quantities <span class="math notranslate nohighlight">\(f\)</span>, <span class="math notranslate nohighlight">\(\dot{f}\)</span>, etc, with the frequency in the range <span class="math notranslate nohighlight">\(f_{\rm ref}&lt;f&lt;f_{\rm ref}+2\Delta F\)</span>. Typically, we find that around 100 points are needed for the frequency grid with fewer points needed for the higher derivatives.</p></li>
<li><p>Evaluate the quantities <span class="math notranslate nohighlight">\(c_{\mathcal{N}m}\)</span>, <span class="math notranslate nohighlight">\(s_{\mathcal{N}m}\)</span>, <span class="math notranslate nohighlight">\(\hat{c}_{\mathcal{N}m}\)</span>, <span class="math notranslate nohighlight">\(\hat{s}_{\mathcal{N}m}\)</span> on these grids and build the interpolators. We use linear interpolation because this is readily available in <cite>jax.scipy</cite>. In practice, this does not need to be done for all values of <span class="math notranslate nohighlight">\(m\)</span> because only those in a narrow range centred on reference frequency will be significant; let <span class="math notranslate nohighlight">\(N_{\rm pixels}\)</span> denote the number of <span class="math notranslate nohighlight">\(m\)</span> values that are interpolated.</p></li>
</ul>
<p>Once the transformer has been set up, it can be used repeatedly to transform waveforms.
Evaluating the transform involves the following steps:</p>
<ol class="arabic simple">
<li><p>The following TD waveform quantities must be provided as inputs: <span class="math notranslate nohighlight">\(A(t)\)</span>, <span class="math notranslate nohighlight">\(\Phi(t)\)</span>, <span class="math notranslate nohighlight">\(2\pi f(t)=\mathrm{d}\Phi/\mathrm{d}t\)</span>, <span class="math notranslate nohighlight">\(2\pi \dot{f}(t)=\mathrm{d}^2\Phi/\mathrm{d}t^2\)</span>, … For simple waveforms these can be provided in the form of analytic functions, for more complicated waveforms they may be in the form of spline interpolants.</p></li>
<li><p>Evaluate the waveform quantities on the sparse grid of wavelet times <span class="math notranslate nohighlight">\(t_n=n\Delta T\)</span> for <span class="math notranslate nohighlight">\(n=0,1,\ldots, N_t\)</span>. This yields the vectors <span class="math notranslate nohighlight">\(A_n=A(t_n)\)</span>, <span class="math notranslate nohighlight">\(\Phi_n=\Phi(t_n)\)</span>, <span class="math notranslate nohighlight">\(f_n=f(t_n)\)</span>, <span class="math notranslate nohighlight">\(\dot{f}_n=\dot{f}(t_n)\)</span>, etc.</p></li>
<li><p>Query the interpolants to evaluate the quantities <span class="math notranslate nohighlight">\(c_{\mathcal{N}m}\)</span>, <span class="math notranslate nohighlight">\(s_{\mathcal{N}m}\)</span>, <span class="math notranslate nohighlight">\(\hat{c}_{\mathcal{N}m}\)</span>, <span class="math notranslate nohighlight">\(\hat{s}_{\mathcal{N}m}\)</span> at the points <span class="math notranslate nohighlight">\((F_n, \dot{f}_n, \ldots)\)</span>, where <span class="math notranslate nohighlight">\(F_n=F(f_n)\)</span>. Also evaluate <span class="math notranslate nohighlight">\(z_n=z(f_n)\)</span>.</p></li>
<li><p>Fill out the arrays for all values of the <span class="math notranslate nohighlight">\(n\)</span> index to find <span class="math notranslate nohighlight">\(c_{nm}(F_n, \dot{f}_n, \ldots)\)</span>, <span class="math notranslate nohighlight">\(s_{nm}(F_n, \dot{f}_n, \ldots)\)</span>, <span class="math notranslate nohighlight">\(\hat{c}_{nm}(F_n, \dot{f}_n, \ldots)\)</span> and <span class="math notranslate nohighlight">\(\hat{s}_{nm}(F_n, \dot{f}_n, \ldots)\)</span> using the time shift properties in Eqs.13 and 14. This step does not require any new calculations, just copying/swapping rows and columns in existing arrays.</p></li>
<li><p>Perform the shifts to find <span class="math notranslate nohighlight">\(c_{nm}(f_n, \dot{f}_n, \ldots)\)</span>, <span class="math notranslate nohighlight">\(s_{nm}(f_n, \dot{f}_n, \ldots)\)</span>, <span class="math notranslate nohighlight">\(\hat{c}_{nm}(f_n, \dot{f}_n, \ldots)\)</span> and <span class="math notranslate nohighlight">\(\hat{s}_{nm}(f_n, \dot{f}_n, \ldots)\)</span> using the frequency shift properties in Eqs.15 and 16. Again, this step does not require any new calculations, just permuting rows and columns in existing arrays.</p></li>
<li><p>Finally, the wavelet coefficients <span class="math notranslate nohighlight">\(w_{nm}\)</span> are given by Eq.9. This step scales the coefficients by the waveform amplitude <span class="math notranslate nohighlight">\(A(t_n)\)</span>.</p></li>
</ol>
<p>We demonstrate the fast TD <span class="math notranslate nohighlight">\(\rightarrow`\)</span> TFD transform using a simple toy waveform.
We use a sine-Gaussian wavepacket with a linearly chirping frequency, see <a class="reference internal" href="#fig-example-waveform"><span class="std std-numref">Figure 3</span></a>.
The amplitude and phase are given by</p>
<div class="math notranslate nohighlight" id="equation-theory-19">
<span class="eqno">(20)<a class="headerlink" href="#equation-theory-19" title="Link to this equation"></a></span>\[A(t) = \exp\left(\frac{-(t-t_c)^2} {2\sigma^2}\right) ,\]</div>
<div class="math notranslate nohighlight" id="equation-theory-20">
<span class="eqno">(21)<a class="headerlink" href="#equation-theory-20" title="Link to this equation"></a></span>\[\Phi(t) = \phi_c + 2\pi f_0 (t-t_c) + \pi \dot{f}_0 (t-t_c)^2 ,\]</div>
<p>where the parameters used were <span class="math notranslate nohighlight">\(\sigma=10^4\,\mathrm{s}\)</span>, <span class="math notranslate nohighlight">\(f_0 = 0.05 \,\mathrm{Hz}\)</span>,
<span class="math notranslate nohighlight">\(\dot{f}_0 = 10^{-6} \,\mathrm{Hz}\,\mathrm{s}^{-1}\)</span>, <span class="math notranslate nohighlight">\(t_c = T/2\)</span>, and <span class="math notranslate nohighlight">\(\phi_c=1\)</span>.</p>
<figure class="align-center" id="id9">
<span id="fig-example-waveform"></span><a class="reference internal image-reference" href="_images/signal.png"><img alt="example_waveform" src="_images/signal.png" style="width: 70%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 3 </span><span class="caption-text">The simple Gaussian wavepacket wavefotm with a frequency that increases linearly with time, as shown by the inset plots.</span><a class="headerlink" href="#id9" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>We can now take the wavelet transform of this signal.</p>
<p>First, we will illustrate the method described above step-by-step; this is shown in <a class="reference internal" href="#fig-step-by-step"><span class="std std-numref">Figure 4</span></a>.
For this example we use <span class="math notranslate nohighlight">\(N_{\rm pixels}=5\)</span> (as plotted in <a class="reference internal" href="#fig-interp-data"><span class="std std-numref">Figure 2</span></a>) and will only interpolate in
one dimension on <span class="math notranslate nohighlight">\(f\)</span> (not <span class="math notranslate nohighlight">\(\dot{f}\)</span> or any higher derivatives) using 50 grid points.</p>
<figure class="align-center" id="id10">
<span id="fig-step-by-step"></span><a class="reference internal image-reference" href="_images/step_illustration.png"><img alt="step_by_step" src="_images/step_illustration.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 4 </span><span class="caption-text">Illustration of the steps involved in the fast wavelet transform.
The first panel shows the <span class="math notranslate nohighlight">\(N_{\rm pixels}=5\)</span> interpolated coefficients <span class="math notranslate nohighlight">\(c_{\mathcal{N},m}(F_n)\)</span> in step 3 of the transform,
these are highlighted by the black rectangle.
There are also interpolated values for the <span class="math notranslate nohighlight">\(s_{\mathcal{N},m}(F_n)\)</span>, <span class="math notranslate nohighlight">\(\hat{c}_{\mathcal{N},m}(F_n)\)</span> and
<span class="math notranslate nohighlight">\(\hat{s}_{\mathcal{N},m}(F_n)\)</span> coefficients which are not shown.
The second panel shows the non-zero <span class="math notranslate nohighlight">\(c_{nm}(F_n)\)</span> coefficients obtained in step 4, these are obtained simply by
copying the coefficients obtained in the previous step horizontally in this diagram.
The third panel shows the <span class="math notranslate nohighlight">\(c_{nm}(f_n)\)</span> coefficients obtained in step 5,
these are obtained simply by translating the coefficients obtained in the previous step vertically in
this diagram by an amount <span class="math notranslate nohighlight">\(z_n\)</span>. The final panel the wavelet coefficients <span class="math notranslate nohighlight">\(w_{nm}\)</span> obtained in step 6
which include the scaling by the waveform amplitude.</span><a class="headerlink" href="#id10" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#fig-comparison"><span class="std std-numref">Figure 5</span></a> shows a comparison of the wavelet transform computed by the fast method described here
(left panel) and computed exactly using the discrete wavelet transform (right panel).
These two signals agree well enough that the differences are not visible in this plot
(the white-noise mismatch between these two signals is <span class="math notranslate nohighlight">\(8.5\times 10^{-3}\)</span>).</p>
<p>The fast transform is indeed fast. On this toy example using small arrays, the fast transform
(left panel <a class="reference internal" href="#fig-comparison"><span class="std std-numref">Figure 5</span></a>) takes <span class="math notranslate nohighlight">\(\sim 2\,\mathrm{ms}\)</span> to evaluate on my laptop using a jitted <cite>jax</cite>
implementation which is a factor <span class="math notranslate nohighlight">\(\sim 3\)</span> faster than computing the discrete wavelet transform numerically
right panel <a class="reference internal" href="#fig-comparison"><span class="std std-numref">Figure 5</span></a>).
The speed up should be more significant for the longer and more complicated waveforms common in LISA data analysis.</p>
<figure class="align-center" id="id11">
<span id="fig-comparison"></span><a class="reference internal image-reference" href="_images/comparison.png"><img alt="comparison" src="_images/comparison.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5 </span><span class="caption-text">Demonstration of the fast TD <span class="math notranslate nohighlight">\(\rightarrow\)</span> TFD wavelet transform.
There are no visible differences between these two plots;
the white-noise mismatch between these two signals is <span class="math notranslate nohighlight">\(8.5\times 10^{-3}\)</span>.</span><a class="headerlink" href="#id11" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Finally, just for the sake of visualisation, it is nice to be able to take an inverse discrete wavelet transform
to recover the original time-domain signal.
This is shown in the <a class="reference internal" href="#fig-signal-reconstructed"><span class="std std-numref">Figure 6</span></a>.</p>
<figure class="align-center" id="id12">
<span id="fig-signal-reconstructed"></span><a class="reference internal image-reference" href="_images/signal_reconstructed.png"><img alt="signal_reconstructed" src="_images/signal_reconstructed.png" style="width: 70%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 6 </span><span class="caption-text">The reconstructed TD signal; the white-noise mismatch with the original signal shown above
is <span class="math notranslate nohighlight">\(8.5\times 10^{-3}\)</span>.</span><a class="headerlink" href="#id12" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The small differences between this an the original signal
(those responsible for the <span class="math notranslate nohighlight">\(8.5\times 10^{-3}\)</span> mismatch) are due to the approximations made by the fast forward transform:
(i) the linear frequency interpolation using just 50 grid points,
(ii) neglecting to interpolate in any higher frequency derivatives,
(iii) approximating the amplitude as constant across each wavelet duration,
(iv) keeping only the loudest <span class="math notranslate nohighlight">\(N_{\rm pixel}=5\)</span> coefficients at each <span class="math notranslate nohighlight">\(n\)</span>,
(v) neglecting the edge effects at small or large values of the <span class="math notranslate nohighlight">\(n\)</span> index, or
(vi) neglecting the zero and Nyquist components of the signal in the <span class="math notranslate nohighlight">\(m=0\)</span> wavelet coefficients.
In this example, the dominant source of error comes from (ii);
repeating this example while also interpolating over <span class="math notranslate nohighlight">\(\dot{f}\)</span> in the range
<span class="math notranslate nohighlight">\((-1.5\times 10^{-6}, 1.5\times 10^{-6})\,\mathrm{Hz}\,\mathrm{s}^{-1}\)</span> using just 3 grid points along this
new dimension improves the mismatch by more than an order of magnitude to <span class="math notranslate nohighlight">\(1.5\times 10^{-4}\)</span>
(see <a class="reference internal" href="#fig-signal-reconstructed-fdot"><span class="std std-numref">Figure 7</span></a>).</p>
<figure class="align-center" id="id13">
<span id="fig-signal-reconstructed-fdot"></span><a class="reference internal image-reference" href="_images/signal_reconstructed_fdot.png"><img alt="signal_reconstructed_fdot" src="_images/signal_reconstructed_fdot.png" style="width: 70%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 7 </span><span class="caption-text">Same as <a class="reference internal" href="#fig-signal-reconstructed"><span class="std std-numref">Figure 6</span></a> when also interpolating over <span class="math notranslate nohighlight">\(\dot{f}\)</span>,
in this case the mismatch improves to <span class="math notranslate nohighlight">\(1.5\times 10^{-4}\)</span>.</span><a class="headerlink" href="#id13" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="fast-wavelet-transform-fd-rightarrow-tfd">
<h2><a class="toc-backref" href="#id18" role="doc-backlink">Fast Wavelet Transform (FD <span class="math notranslate nohighlight">\(\rightarrow\)</span> TFD)</a><a class="headerlink" href="#fast-wavelet-transform-fd-rightarrow-tfd" title="Link to this heading"></a></h2>
<p>Suppose the waveform model is defined in the FD in terms of its amplitude <span class="math notranslate nohighlight">\(A(f)\)</span> and phase <span class="math notranslate nohighlight">\(\Phi(f)\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-theory-21">
<span class="eqno">(22)<a class="headerlink" href="#equation-theory-21" title="Link to this equation"></a></span>\[\tilde{h}(f) = \tilde{h}^+(f)-i\tilde{h}^\times(f) = A(f) \exp\big(i \Phi(f)\big) ,\]</div>
<p>where the amplitude and phase derivative <span class="math notranslate nohighlight">\(\mathrm{d}\Phi/\mathrm{d}f\)</span> change slowly with frequency;
i.e.they change by a small amount over the wavelet resolution <span class="math notranslate nohighlight">\(\Delta F\)</span>.
Generally, a waveform may contain a sum of harmonics of this form.
This is what is meant by a “harmonic-based” FD waveform.</p>
<p>The fast FD <span class="math notranslate nohighlight">\(\rightarrow\)</span> TDF transform is conceptually similar to the FD <span class="math notranslate nohighlight">\(\rightarrow\)</span> TDF transform described
in the above section except that we expand the phase in frequency.
The relationship between the two fast transforms is nicely captured by the diagram in <a class="reference internal" href="#fig-diagram"><span class="std std-numref">Figure 8</span></a>.</p>
<figure class="align-center" id="id14">
<span id="fig-diagram"></span><a class="reference internal image-reference" href="_images/diagram.png"><img alt="diagram" src="_images/diagram.png" style="width: 70%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 8 </span><span class="caption-text">Illustration of the time-frequency decomposition of a waveform harmonic.
The horizontal (blue) shaded region indicates where the fast TD <span class="math notranslate nohighlight">\(\rightarrow\)</span> TFD transform is applicable,
while the vertical (red) region indicates where the fast FD <span class="math notranslate nohighlight">\(\rightarrow\)</span> TFD transform is applicable.
Diagram reproduced from Ref. <a class="footnote-reference brackets" href="#id6" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</span><a class="headerlink" href="#id14" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>SO FAR I HAVE ONLY IMPLEMENTED THE TRANSFORM FROM THE TIME DOMAIN. THIS FD ONE IS COMING NEXT. WATCH THIS SPACE!</p>
</section>
<section id="references">
<h2><a class="toc-backref" href="#id19" role="doc-backlink">References</a><a class="headerlink" href="#references" title="Link to this heading"></a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id5" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id3">2</a>)</span>
<p>V. Necula, S. Klimenko &amp; G. Mitselmakher, <em>Transient analysis with fast Wilson-Daubechies time-frequency transform</em>, Journal of Physics: Conference Series 363 012032, 2012.
<a class="reference external" href="https://iopscience.iop.org/article/10.1088/1742-6596/363/1/012032">DOI 10.1088/1742-6596/363/1/012032</a></p>
</aside>
<aside class="footnote brackets" id="id6" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id4">2</a>)</span>
<p>N. J. Cornish, <em>Time-Frequency Analysis of Gravitational Wave Data</em>, Physical Review D 102 124038, 2020.
<a class="reference external" href="https://arxiv.org/abs/2009.00043">arXiv:2009.00043</a></p>
</aside>
</aside>
</section>
<section id="appendices">
<h2><a class="toc-backref" href="#id20" role="doc-backlink">Appendices</a><a class="headerlink" href="#appendices" title="Link to this heading"></a></h2>
</section>
<section id="appendix-a-derivation-of-time-shift-properties">
<h2><a class="toc-backref" href="#id21" role="doc-backlink">Appendix A: Derivation of Time-Shift Properties</a><a class="headerlink" href="#appendix-a-derivation-of-time-shift-properties" title="Link to this heading"></a></h2>
<p>Starting from the integral definitions of the <span class="math notranslate nohighlight">\(c_{nm}\)</span> and <span class="math notranslate nohighlight">\(s_{nm}\)</span> coefficients in
Eqs.10 and 11, and their corresponding duals, and evaluating these at <span class="math notranslate nohighlight">\(m=0\)</span> gives</p>
<div class="math notranslate nohighlight" id="equation-theory-22">
<span class="eqno">(23)<a class="headerlink" href="#equation-theory-22" title="Link to this equation"></a></span>\[c_{0m}(f,\dot{f},\ldots) = \int_{-\infty}^{\infty}\mathrm{d}t\; \cos X_0(f,\dot{f},\ldots) g_{0m}(t) ,\]</div>
<div class="math notranslate nohighlight" id="equation-theory-23">
<span class="eqno">(24)<a class="headerlink" href="#equation-theory-23" title="Link to this equation"></a></span>\[s_{0m}(f,\dot{f},\ldots) = \int_{-\infty}^{\infty}\mathrm{d}t\; \sin X_0(f,\dot{f},\ldots) g_{0m}(t),\]</div>
<div class="math notranslate nohighlight" id="equation-theory-24">
<span class="eqno">(25)<a class="headerlink" href="#equation-theory-24" title="Link to this equation"></a></span>\[\hat{c}_{0m}(f,\dot{f},\ldots) = \int_{-\infty}^{\infty}\mathrm{d}t\; \cos X_0(f,\dot{f},\ldots) \hat{g}_{0m}(t) ,\]</div>
<div class="math notranslate nohighlight" id="equation-theory-25">
<span class="eqno">(26)<a class="headerlink" href="#equation-theory-25" title="Link to this equation"></a></span>\[\hat{s}_{0m}(f,\dot{f},\ldots) = \int_{-\infty}^{\infty}\mathrm{d}t\; \sin X_0(f,\dot{f},\ldots) \hat{g}_{0m}(t).\]</div>
<p>Changing the integration variable to <span class="math notranslate nohighlight">\(t'=t+n\Delta T\)</span> (and dropping the prime on <span class="math notranslate nohighlight">\(t\)</span>) gives</p>
<div class="math notranslate nohighlight" id="equation-theory-26">
<span class="eqno">(27)<a class="headerlink" href="#equation-theory-26" title="Link to this equation"></a></span>\[c_{0m}(f,\dot{f},\ldots) = \int_{-\infty}^{\infty}\mathrm{d}t\; \cos X_n(f,\dot{f},\ldots) g_{0m}(t-n\Delta T) ,\]</div>
<div class="math notranslate nohighlight" id="equation-theory-27">
<span class="eqno">(28)<a class="headerlink" href="#equation-theory-27" title="Link to this equation"></a></span>\[s_{0m}(f,\dot{f},\ldots) = \int_{-\infty}^{\infty}\mathrm{d}t\; \sin X_n(f,\dot{f},\ldots) g_{0m}(t-n\Delta T),\]</div>
<div class="math notranslate nohighlight" id="equation-theory-28">
<span class="eqno">(29)<a class="headerlink" href="#equation-theory-28" title="Link to this equation"></a></span>\[\hat{c}_{0m}(f,\dot{f},\ldots) = \int_{-\infty}^{\infty}\mathrm{d}t\; \cos X_n(f,\dot{f},\ldots) \hat{g}_{0m}(t-n\Delta T) ,\]</div>
<div class="math notranslate nohighlight" id="equation-theory-29">
<span class="eqno">(30)<a class="headerlink" href="#equation-theory-29" title="Link to this equation"></a></span>\[\hat{s}_{0m}(f,\dot{f},\ldots) = \int_{-\infty}^{\infty}\mathrm{d}t\; \sin X_n(f,\dot{f},\ldots) \hat{g}_{0m}(t-n\Delta T).\]</div>
<p>Using the following time-translation property of the basis wavelets
(these follow directly from the definitions of the wavelet basis functions and their duals in Eqs.1 and 2)</p>
<div class="math notranslate nohighlight" id="equation-theory-30">
<span class="eqno">(31)<a class="headerlink" href="#equation-theory-30" title="Link to this equation"></a></span>\[\begin{split}g_{0m}(t-n\Delta T) = \begin{cases}
    g_{nm}(t) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{even} \\
    \hat{g}_{nm}(t) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{odd}
\end{cases} ,\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-theory-31">
<span class="eqno">(32)<a class="headerlink" href="#equation-theory-31" title="Link to this equation"></a></span>\[\begin{split}\hat{g}_{0m}(t-n\Delta T) = \begin{cases}
    \hat{g}_{nm}(t) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{even} \\
    g_{nm}(t) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{odd}
\end{cases} ,\end{split}\]</div>
<p>gives</p>
<div class="math notranslate nohighlight" id="equation-theory-32">
<span class="eqno">(33)<a class="headerlink" href="#equation-theory-32" title="Link to this equation"></a></span>\[\begin{split}c_{0m}(f, \dot{f},\ldots) = \begin{cases}
    c_{nm}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{even} \\
    \hat{c}_{nm}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{odd}
\end{cases} ,\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-theory-33">
<span class="eqno">(34)<a class="headerlink" href="#equation-theory-33" title="Link to this equation"></a></span>\[\begin{split}s_{0m}(f, \dot{f},\ldots) = \begin{cases}
    s_{nm}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{even} \\
    \hat{s}_{nm}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{odd}
\end{cases} ,\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-theory-34">
<span class="eqno">(35)<a class="headerlink" href="#equation-theory-34" title="Link to this equation"></a></span>\[\begin{split}\hat{c}_{0m}(f, \dot{f},\ldots) = \begin{cases}
    \hat{c}_{nm}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{even} \\
    c_{nm}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{odd}
\end{cases} ,\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-theory-35">
<span class="eqno">(36)<a class="headerlink" href="#equation-theory-35" title="Link to this equation"></a></span>\[\begin{split}\hat{s}_{0m}(f, \dot{f},\ldots) = \begin{cases}
    \hat{s}_{nm}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{even} \\
    s_{nm}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{odd}
\end{cases} .\end{split}\]</div>
<p>Inverting these expressions to find <span class="math notranslate nohighlight">\(c_{nm}\)</span> and <span class="math notranslate nohighlight">\(s_{nm}\)</span> gives</p>
<div class="math notranslate nohighlight" id="equation-theory-36">
<span class="eqno">(37)<a class="headerlink" href="#equation-theory-36" title="Link to this equation"></a></span>\[\begin{split}c_{nm}(f, \dot{f},\ldots) = \begin{cases}
    c_{0m}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{even} \\
    \hat{c}_{0m}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{odd}
\end{cases} ,\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-theory-37">
<span class="eqno">(38)<a class="headerlink" href="#equation-theory-37" title="Link to this equation"></a></span>\[\begin{split}s_{nm}(f, \dot{f},\ldots) = \begin{cases}
    s_{0m}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{even} \\
    \hat{s}_{0m}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{odd}
\end{cases} .\end{split}\]</div>
<p>Finally, because we have shown that the coefficient only depend on the parity of the index <span class="math notranslate nohighlight">\(n\)</span>,
we can replace <span class="math notranslate nohighlight">\(n=0\)</span> in these expressions with any other even integer <span class="math notranslate nohighlight">\(\mathcal{N}\)</span>.
This gives the results in Eqs.13 and 14 of the main text;</p>
<div class="math notranslate nohighlight" id="equation-theory-38">
<span class="eqno">(39)<a class="headerlink" href="#equation-theory-38" title="Link to this equation"></a></span>\[\begin{split}c_{nm}(f, \dot{f},\ldots) &amp;= \begin{cases}
    c_{\mathcal{N}m}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{even} \\
    \hat{c}_{\mathcal{N}m}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{odd}
\end{cases} ,\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-theory-39">
<span class="eqno">(40)<a class="headerlink" href="#equation-theory-39" title="Link to this equation"></a></span>\[\begin{split}s_{nm}(f, \dot{f},\ldots) &amp;= \begin{cases}
    s_{\mathcal{N}m}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{even} \\
    \hat{s}_{\mathcal{N}m}(f, \dot{f},\ldots) &amp; \mathrm{if}\;n\;\mathrm{is}\;\mathrm{odd}
\end{cases} .\end{split}\]</div>
<p>Note that these results do not hold precisely for the discrete wavelet transform
(i.e. if the integrals over <span class="math notranslate nohighlight">\(t\)</span> are replaced with finite sums)
for values of <span class="math notranslate nohighlight">\(n\)</span> near the beginning and end of the allowed range.
This is discussed in more detail in the main text.</p>
</section>
<section id="appendix-b-derivation-of-freq-shift-properties">
<h2><a class="toc-backref" href="#id22" role="doc-backlink">Appendix B: Derivation of Freq-Shift Properties</a><a class="headerlink" href="#appendix-b-derivation-of-freq-shift-properties" title="Link to this heading"></a></h2>
<p>Start from the definitions of the <span class="math notranslate nohighlight">\(c_{nm}\)</span> and <span class="math notranslate nohighlight">\(s_{nm}\)</span> coefficients in
Eqs.10 and 11, shift by an even multiple of the wavelet frequency resolution; <span class="math notranslate nohighlight">\(f\rightarrow f+2z\Delta F\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-theory-40">
<span class="eqno">(41)<a class="headerlink" href="#equation-theory-40" title="Link to this equation"></a></span>\[c_{nm}(f+z\Delta F) = \int\mathrm{d}t\;\cos\big(X_n(f)+4\pi z[t-t_n] \Delta F\big)g_{nm}(t)\]</div>
<div class="math notranslate nohighlight" id="equation-theory-41">
<span class="eqno">(42)<a class="headerlink" href="#equation-theory-41" title="Link to this equation"></a></span>\[s_{nm}(f+z\Delta F) = \int\mathrm{d}t\;\sin\big(X_n(f)+4\pi z[t-t_n] \Delta F\big)g_{nm}(t)\]</div>
<p>Throughout this appendix, we will simplify our notation by assuming that all quantities like
<span class="math notranslate nohighlight">\(c_{nm}(f, \dot{f}, \ldots)\)</span>, <span class="math notranslate nohighlight">\(s_{nm}(f, \dot{f}, \ldots)\)</span>, and <span class="math notranslate nohighlight">\(X_{n}(f, \dot{f}, \ldots)\)</span>
depend only on the frequency <span class="math notranslate nohighlight">\(f\)</span> and suppress any dependence on higher derivatives of the phase in our notation.
This will not effect any of our conclusions.</p>
<p>We now consider the cases of odd and even <span class="math notranslate nohighlight">\(n+m\)</span> separately.</p>
<p>CASE #1: <span class="math notranslate nohighlight">\(n+m\)</span> EVEN</p>
<p>Substituting the wavelet definition into the expressions for the shifted coefficients gives</p>
<div class="math notranslate nohighlight" id="equation-theory-42">
<span class="eqno">(43)<a class="headerlink" href="#equation-theory-42" title="Link to this equation"></a></span>\[c_{nm}(f+2z\Delta F) = \sqrt{2} \int\mathrm{d}t\; \cos\big(X_n(f)+4\pi z [t-n\Delta T] \Delta F\big) \cos\big(2\pi m [t-n\Delta T] \Delta F\big) \phi(t-n\Delta T),\]</div>
<div class="math notranslate nohighlight" id="equation-theory-43">
<span class="eqno">(44)<a class="headerlink" href="#equation-theory-43" title="Link to this equation"></a></span>\[s_{nm}(f+2z\Delta F) = \sqrt{2} \int\mathrm{d}t\; \sin\big(X_n(f)+4\pi z [t-n\Delta T] \Delta F\big) \cos\big(2\pi m [t-n\Delta T] \Delta F\big) \phi(t-n\Delta T).\]</div>
<p>Using the compound angle trigonometric formulae and separating terms this becomes</p>
<div class="math notranslate nohighlight" id="equation-theory-44">
<span class="eqno">(45)<a class="headerlink" href="#equation-theory-44" title="Link to this equation"></a></span>\[\begin{split}c_{nm}(f+2z\Delta F) = \sqrt{2} \int\mathrm{d}t\; \cos X_n(f) \cos\big(4\pi z [t-n\Delta T] \Delta F\big) \cos\big(2\pi m[t-n\Delta T]\Delta F\big) \phi(t-n\Delta T) \nonumber \\
 - \sqrt{2} \int\mathrm{d}t\; \sin X_n(f) \sin\big(4\pi z [t-n\Delta T] \Delta F\big) \cos\big(2\pi m [t-n\Delta T] \Delta F\big) \phi(t-n\Delta T),\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-theory-45">
<span class="eqno">(46)<a class="headerlink" href="#equation-theory-45" title="Link to this equation"></a></span>\[\begin{split}s_{nm}(f+2z\Delta F) = \sqrt{2} \int\mathrm{d}t\; \cos X_n(f) \sin\big(4\pi z [t-n\Delta T] \Delta F\big) \cos\big(2\pi m[t-n\Delta T]\Delta F\big) \phi(t-n\Delta T) \nonumber \\
 + \sqrt{2} \int\mathrm{d}t\; \sin X_n(f) \cos\big(4\pi z [t-n\Delta T] \Delta F\big) \cos\big(2\pi m[t-n\Delta T]\Delta F\big) \phi(t-n\Delta T).\end{split}\]</div>
<p>Using the trig identities <span class="math notranslate nohighlight">\(\cos A \cos B = \frac{1}{2}\big(\cos[A-B]+\cos[A+B]\big)`\)</span> and
<span class="math notranslate nohighlight">\(\sin A \cos B = \frac{1}{2}\big(\sin[A-B]+\sin[A+B]\big)\)</span> this becomes</p>
<div class="math notranslate nohighlight" id="equation-theory-46">
<span class="eqno">(47)<a class="headerlink" href="#equation-theory-46" title="Link to this equation"></a></span>\[\begin{split}c_{nm}(f+2z\Delta F) =
\frac{1}{\sqrt{2}} \int\mathrm{d}t\; \cos X_n(f) \cos\big(2\pi[m-2z][t-n\Delta T]\Delta F\big) \phi(t-n\Delta T)  \\
+\frac{1}{\sqrt{2}} \int\mathrm{d}t\; \cos X_n(f) \cos\big(2\pi[m+2z][t-n\Delta T]\Delta F\big) \phi(t-n\Delta T)  \\
+\frac{1}{\sqrt{2}} \int\mathrm{d}t\; \sin X_n(f) \sin\big(2\pi[m-2z][t-n\Delta T]\Delta F\big) \phi(t-n\Delta T)  \\
-\frac{1}{\sqrt{2}} \int\mathrm{d}t\; \sin X_n(f) \sin\big(2\pi[m+2z][t-n\Delta T]\Delta F\big) \phi(t-n\Delta T) , \\\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-theory-47">
<span class="eqno">(48)<a class="headerlink" href="#equation-theory-47" title="Link to this equation"></a></span>\[\begin{split}s_{nm}(f+2z\Delta F) =
\frac{-1}{\sqrt{2}} \int\mathrm{d}t\; \cos X_n(f) \sin\big(2\pi[m-2z][t-n\Delta T]\Delta F\big) \phi(t-n\Delta T)  \\
+\frac{1}{\sqrt{2}} \int\mathrm{d}t\; \cos X_n(f) \sin\big(2\pi[m+2z][t-n\Delta T]\Delta F\big) \phi(t-n\Delta T)  \\
+\frac{1}{\sqrt{2}} \int\mathrm{d}t\; \sin X_n(f) \cos\big(2\pi[m-2z][t-n\Delta T]\Delta F\big) \phi(t-n\Delta T)  \\
+\frac{1}{\sqrt{2}} \int\mathrm{d}t\; \sin X_n(f) \cos\big(2\pi[m+2z][t-n\Delta T]\Delta F\big) \phi(t-n\Delta T) .\end{split}\]</div>
<p>Finally, using the definitions of <span class="math notranslate nohighlight">\(g_{nm}\)</span>, <span class="math notranslate nohighlight">\(c_{nm}\)</span>, and <span class="math notranslate nohighlight">\(s_{nm}\)</span> (and their dual equivalents),
this simplifies to a result involving the coefficients evaluated at frequency <span class="math notranslate nohighlight">\(f\)</span>;</p>
<div class="math notranslate nohighlight" id="equation-theory-48">
<span class="eqno">(49)<a class="headerlink" href="#equation-theory-48" title="Link to this equation"></a></span>\[c_{nm}(f+2z\Delta F) = \frac{1}{2} \Big( c_{n(m-2z)}(f) + c_{n(m+2z)}(f) + \hat{s}_{n(m-2z)}(f) - \hat{s}_{n(m+2z)}(f) \Big) ,\]</div>
<div class="math notranslate nohighlight" id="equation-theory-49">
<span class="eqno">(50)<a class="headerlink" href="#equation-theory-49" title="Link to this equation"></a></span>\[s_{nm}(f+2z\Delta F) = \frac{1}{2} \Big( s_{n(m-2z)}(f)+s_{n(m+2z)}(f) - \hat{c}_{n(m-2z)}(f) + \hat{c}_{n(m+2z)}(f) \Big) .\]</div>
<p>Note that this is that step that requires the frequency shift to be an even multiple of <span class="math notranslate nohighlight">\(\Delta F\)</span>;
this is needed because if <span class="math notranslate nohighlight">\(n+m\)</span> is even then so is <span class="math notranslate nohighlight">\(n+m\pm 2z\)</span> and we can still use the same case
in the wavelet definition.</p>
<p>CASE #1: <span class="math notranslate nohighlight">\(n+m\)</span> ODD</p>
<p>An identical procedure in this case gives</p>
<div class="math notranslate nohighlight" id="equation-theory-50">
<span class="eqno">(51)<a class="headerlink" href="#equation-theory-50" title="Link to this equation"></a></span>\[c_{nm}(f+2z\Delta F) = \frac{1}{2} \Big( c_{n(m-2z)}(f) + c_{n(m+2z)}(f) - \hat{s}_{n(m-2z)}(f) + \hat{s}_{n(m+2z)}(f) \Big) ,\]</div>
<div class="math notranslate nohighlight" id="equation-theory-51">
<span class="eqno">(52)<a class="headerlink" href="#equation-theory-51" title="Link to this equation"></a></span>\[s_{nm}(f+2z\Delta F) = \frac{1}{2} \Big( s_{n(m-2z)}(f) + s_{n(m+2z)}(f) + \hat{c}_{n(m-2z)}(f) - \hat{c}_{n(m+2z)}(f) \Big) .\]</div>
<p>The final step involves taking care of the differing signs in these equations by
inserting appropriate factors of <span class="math notranslate nohighlight">\((-1)^{n+m}\)</span>.
This gives the results in Eqs.15 and 16 valid for all <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(m\)</span>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="TimeFrequencyWaveforms Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api/TimeFrequencyWaveforms.code.utils.html" class="btn btn-neutral float-right" title="TimeFrequencyWaveforms.code.utils module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Christopher J. Moore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>